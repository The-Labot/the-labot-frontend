server{
	listen 80;

	location / {
		root /usr/share/nginx/html; # 파일을 어디서 찾을까
		index index.html index.htm; # 사용자가 파일명을 지정하지 않았을 때 기본으로 보여줄 파일
		try_files $uri $uri/ /index.html; # SPA 필수 설정. 요청한 파일 있으면 그걸 주고 없으면 폴더 확인해보고 그래도 없으면 기본 보여줘
	}

	location /api/{
		proxy_pass http://backend:8080;
		
		# 그냥 넘기면 백엔드 입장에선 요청 보낸 사람이 nginx(도커 내부 ip로 보임)
		# 그래서 원래 요청한 사람의 진짜 정보는 이거다 라고 꼬리표(Header)를 붙여서 보냄 그래야 로그에 진짜 사용자 ip 찍힘
		proxy_set_header Host $host;
		proxy_set_header X-Real-IP $remote_addr;
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header X-Forwarded-Proto $scheme;
	}
}
